<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<title>Light of the Hour · 세계의 시간, 하나의 빛</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
  *{box-sizing:border-box;margin:0;padding:0;}

  body{
    min-height:100vh;
    background:#020307;
    color:#f5f4f2;
    font-family: system-ui, -apple-system, BlinkMacSystemFont,
      "SF Pro Text", "Noto Sans KR", sans-serif;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
    overflow:hidden;
    transition:background 1s ease;
  }

  .layer{
    position:relative;
    width:100%;
    max-width:960px;
    aspect-ratio:16/9;
    border-radius:24px;
    background:
      radial-gradient(circle at 50% -10%, rgba(255,255,255,0.02) 0%, transparent 50%),
      radial-gradient(circle at 50% 120%, rgba(0,0,0,0.9) 0%, #000 65%);
    box-shadow:0 40px 80px rgba(0,0,0,0.9);
    overflow:hidden;
  }

  /* 상단: 프리셋 + 입력 */
  .locations{
    position:absolute;
    top:14px;
    left:50%;
    transform:translateX(-50%);
    display:flex;
    flex-wrap:wrap;
    gap:6px;
    justify-content:center;
    padding:8px 10px;
    border-radius:999px;
    background:rgba(0,0,0,0.7);
    backdrop-filter:blur(14px);
    z-index:10; /* 제일 위로 */
  }

  .loc-presets{
    display:flex;
    flex-wrap:wrap;
    gap:6px;
    justify-content:center;
  }

  .loc-btn{
    border:none;
    outline:none;
    padding:4px 10px;
    border-radius:999px;
    background:transparent;
    color:#f5f4f2;
    font-size:11px;
    letter-spacing:0.14em;
    text-transform:uppercase;
    opacity:0.6;
    cursor:pointer;
    transition:background 0.25s ease, opacity 0.25s ease, transform 0.2s ease;
    white-space:nowrap;
  }
  .loc-btn:hover{
    opacity:0.9;
  }
  .loc-btn.is-active{
    opacity:1;
    background:rgba(255,255,255,0.12);
    transform:translateY(-1px);
  }

  .loc-input{
    display:flex;
    align-items:center;
    gap:4px;
    margin-left:8px;
  }
  .loc-input input{
    border:none;
    outline:none;
    padding:4px 8px;
    border-radius:999px;
    font-size:11px;
    background:rgba(255,255,255,0.06);
    color:#f5f4f2;
    min-width:110px;
  }
  .loc-input input::placeholder{
    color:rgba(245,244,242,0.5);
  }
  .loc-input button{
    border:none;
    outline:none;
    padding:4px 8px;
    border-radius:999px;
    font-size:11px;
    letter-spacing:0.14em;
    text-transform:uppercase;
    background:rgba(255,255,255,0.14);
    color:#f5f4f2;
    cursor:pointer;
  }

  /* 중앙의 빛 원 */
  .halo{
    position:absolute;
    left:50%;
    top:50%;
    width:min(55vmin,460px);
    height:min(55vmin,460px);
    transform:translate(-50%,-50%);
    border-radius:50%;
    background:
      radial-gradient(circle at 50% 40%,
        rgba(255,255,255,0.85) 0%,
        rgba(255,240,210,0.75) 16%,
        rgba(255,210,140,0.45) 32%,
        transparent 70%);
    opacity:0.0;
    filter:blur(0px);
    box-shadow:none;
    transition:
      background 1.4s ease,
      opacity 1.4s ease,
      filter 1.4s ease,
      box-shadow 1.4s ease;
    animation:breathe 14s ease-in-out infinite;
  }

  @keyframes breathe {
    0%   { transform:translate(-50%,-50%) scale(1.00); }
    50%  { transform:translate(-50%,-50%) scale(1.04); }
    100% { transform:translate(-50%,-50%) scale(1.00); }
  }

  /* 텍스트 레이어 */
  .content{
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-end;
    padding:40px 24px 30px;
    background:linear-gradient(to top, rgba(0,0,0,0.75), transparent 40%);
    /* pointer-events 제거해서 폼에 영향 안 주게 */
  }

  .place{
    font-size:11px;
    letter-spacing:0.2em;
    text-transform:uppercase;
    opacity:0.75;
    margin-bottom:8px;
  }

  .time{
    font-size:clamp(28px,4vw,40px);
    letter-spacing:0.14em;
    text-transform:uppercase;
    margin-bottom:6px;
    font-variant-numeric:tabular-nums;
  }

  .label{
    font-size:12px;
    letter-spacing:0.2em;
    text-transform:uppercase;
    opacity:0.75;
    margin-bottom:18px;
  }

  .poem{
    font-size:14px;
    line-height:1.7;
    text-align:center;
    max-width:460px;
    opacity:0.9;
    white-space:pre-line;
  }

  .poem small{
    display:block;
    margin-top:6px;
    font-size:12px;
    opacity:0.6;
  }

  /* 상태별 빛의 표정 */

  body.state-deepnight .halo{
    opacity:0.28;
    background:
      radial-gradient(circle at 48% 42%,
        rgba(180,205,255,0.75) 0%,
        rgba(110,145,210,0.45) 22%,
        rgba(40,70,120,0.25) 40%,
        transparent 70%);
    filter:blur(6px);
    box-shadow:
      0 0 40px rgba(90,140,220,0.45),
      0 0 120px rgba(10,20,60,0.8);
  }

  body.state-dawn .halo{
    opacity:0.36;
    background:
      radial-gradient(circle at 50% 38%,
        rgba(255,245,230,0.9) 0%,
        rgba(255,225,190,0.75) 20%,
        rgba(255,190,140,0.45) 40%,
        transparent 70%);
    filter:blur(5px);
    box-shadow:
      0 0 40px rgba(255,210,160,0.5),
      0 0 120px rgba(80,60,40,0.8);
  }

  body.state-day .halo{
    opacity:0.12;
    background:
      radial-gradient(circle at 52% 38%,
        rgba(255,255,240,0.85) 0%,
        rgba(240,240,220,0.6) 18%,
        rgba(220,220,200,0.3) 34%,
        transparent 65%);
    filter:blur(7px);
    box-shadow:
      0 0 26px rgba(255,255,230,0.32),
      0 0 80px rgba(0,0,0,0.7);
  }

  body.state-sunset .halo{
    opacity:0.52;
    background:
      radial-gradient(circle at 50% 40%,
        rgba(255,245,230,0.9) 0%,
        rgba(255,220,180,0.8) 20%,
        rgba(255,170,110,0.55) 40%,
        transparent 72%);
    filter:blur(5px);
    box-shadow:
      0 0 50px rgba(255,210,150,0.9),
      0 0 140px rgba(120,70,40,0.95);
  }

  body.state-night .halo{
    opacity:0.46;
    background:
      radial-gradient(circle at 50% 40%,
        rgba(255,240,220,0.95) 0%,
        rgba(255,215,170,0.8) 22%,
        rgba(255,180,120,0.55) 42%,
        transparent 74%);
    filter:blur(4px);
    box-shadow:
      0 0 60px rgba(255,215,160,0.95),
      0 0 160px rgba(255,160,100,0.8);
  }

  @media (max-width:640px){
    .layer{ border-radius:18px; }
    .content{
      padding:30px 18px 24px;
    }
    .locations{
      top:10px;
      padding:6px 8px;
    }
    .loc-btn{
      font-size:10px;
      letter-spacing:0.12em;
    }
    .loc-input input{
      min-width:90px;
    }
    .loc-input button{
      display:none; /* 모바일에서는 엔터로만 설정 */
    }
  }
</style>
</head>
<body>
  <div class="layer">
    <!-- 세계 도시 선택 -->
    <div class="locations">
      <div class="loc-presets">
        <button class="loc-btn is-active"
                data-tz="local"
                data-label="Your device">
          Your device
        </button>
        <button class="loc-btn"
                data-tz="America/New_York"
                data-label="New York">
          New York
        </button>
        <button class="loc-btn"
                data-tz="Europe/London"
                data-label="London">
          London
        </button>
        <button class="loc-btn"
                data-tz="Asia/Seoul"
                data-label="Seoul">
          Seoul
        </button>
        <button class="loc-btn"
                data-tz="Australia/Sydney"
                data-label="Sydney">
          Sydney
        </button>
      </div>
      <form class="loc-input" id="locForm">
        <input id="locInput" type="text" autocomplete="off"
               placeholder="type a city…">
        <button type="submit">SET</button>
      </form>
    </div>

    <div class="halo" aria-hidden="true"></div>

    <div class="content">
      <div id="place" class="place">Your device · Local time</div>
      <div id="time" class="time">--:--:--</div>
      <div id="label" class="label">—</div>
      <div id="poem" class="poem">
지금 이 시간, 이 위치의 빛을 불러오는 중입니다.
<small>Fetching the light for this place and this hour.</small>
      </div>
    </div>
  </div>

<script>
  const timeEl  = document.getElementById('time');
  const placeEl = document.getElementById('place');
  const labelEl = document.getElementById('label');
  const poemEl  = document.getElementById('poem');
  const locButtons = document.querySelectorAll('.loc-btn');
  const locForm    = document.getElementById('locForm');
  const locInput   = document.getElementById('locInput');

  const STATES = ['deepnight','dawn','day','sunset','night'];

  const CITY_TIMEZONES = {
    'new york':        { tz:'America/New_York', label:'New York' },
    'nyc':             { tz:'America/New_York', label:'New York' },
    'seoul':           { tz:'Asia/Seoul',       label:'Seoul' },
    '서울':              { tz:'Asia/Seoul',       label:'Seoul' },
    'london':          { tz:'Europe/London',    label:'London' },
    'tokyo':           { tz:'Asia/Tokyo',       label:'Tokyo' },
    '도쿄':              { tz:'Asia/Tokyo',       label:'Tokyo' },
    'paris':           { tz:'Europe/Paris',     label:'Paris' },
    'berlin':          { tz:'Europe/Berlin',    label:'Berlin' },
    'sydney':          { tz:'Australia/Sydney', label:'Sydney' },
    'sao paulo':       { tz:'America/Sao_Paulo',label:'São Paulo' },
    'são paulo':       { tz:'America/Sao_Paulo',label:'São Paulo' },
    'mexico city':     { tz:'America/Mexico_City', label:'Mexico City' },
    'la':              { tz:'America/Los_Angeles',label:'Los Angeles' },
    'los angeles':     { tz:'America/Los_Angeles',label:'Los Angeles' },
    'san francisco':   { tz:'America/Los_Angeles',label:'San Francisco' },
    'cairo':           { tz:'Africa/Cairo',     label:'Cairo' },
    'johannesburg':    { tz:'Africa/Johannesburg', label:'Johannesburg' },
    'mumbai':          { tz:'Asia/Kolkata',     label:'Mumbai' }
  };

  let currentTZ = 'local';
  let currentLabel = 'Your device';
  let usingFallbackLocal = false;

  function pad(n){ return n < 10 ? '0' + n : '' + n; }

  function getState(hour){
    if(hour >= 0 && hour < 5)   return 'deepnight';
    if(hour >= 5 && hour < 9)   return 'dawn';
    if(hour >= 9 && hour < 16)  return 'day';
    if(hour >= 16 && hour < 20) return 'sunset';
    return 'night';
  }

  function getTextFor(state, hour, minute, label){
    const hhmm = `${pad(hour)}:${pad(minute)}`;
    const whereK = (currentTZ === 'local')
      ? '여기'
      : label;
    const whereEn = (currentTZ === 'local')
      ? 'here'
      : label;

    let extraNote = '';
    if(usingFallbackLocal && currentTZ === 'local'){
      extraNote =
        '\n\n이 도시는 이 데모에서 시간대를 알 수 없어,\n기기의 현재 시간으로 빛을 보여줍니다.' +
        `\n<small>This city is not in the demo’s timezone map,\nso the lamp follows your device time.</small>`;
    }

    if(state === 'deepnight'){
      return {
        label: `깊은 밤 · Deep Night`,
        poem:
`${whereK}의 ${hhmm}
빛은 가장 적은 말로 머물러 있습니다.
<small>In ${whereEn}, light stays with the fewest words.</small>${extraNote}`
      };
    }
    if(state === 'dawn'){
      return {
        label: `새벽 · Dawn`,
        poem:
`${whereK}의 ${hhmm}
어둠과 아침 사이, 빛이 천천히 숨을 들이킵니다.
<small>Between night and morning in ${whereEn}, light takes a slow breath in.</small>${extraNote}`
      };
    }
    if(state === 'day'){
      return {
        label: `낮 · Daylight`,
        poem:
`${whereK}의 ${hhmm}
너무 밝아서, 조명은 잠시 잊혀집니다.
<small>So bright in ${whereEn} that the lamp can afford to be forgotten.</small>${extraNote}`
      };
    }
    if(state === 'sunset'){
      return {
        label: `저녁 · Golden Hour`,
        poem:
`${whereK}의 ${hhmm}
해가 물러나자, 빛은 제 목소리를 찾습니다.
<small>As the sun retreats in ${whereEn}, the lamp finds its own voice.</small>${extraNote}`
      };
    }
    return {
      label: `밤 · Night`,
      poem:
`${whereK}의 ${hhmm}
어둠이 짙어질수록, 빛은 더 또렷해집니다.
<small>The darker it grows in ${whereEn}, the clearer the light becomes.</small>${extraNote}`
    };
  }

  function getNowForTZ(tz){
    if(tz === 'local') return new Date();
    const now = new Date();
    const localeString = now.toLocaleString('en-US', { timeZone: tz });
    return new Date(localeString);
  }

  function updateScene(){
    const now = getNowForTZ(currentTZ);
    const hour  = now.getHours();
    const min   = now.getMinutes();
    const sec   = now.getSeconds();

    timeEl.textContent = `${pad(hour)}:${pad(min)}:${pad(sec)}`;

    if(currentTZ === 'local' && !usingFallbackLocal){
      placeEl.textContent = 'Your device · Local time';
    }else if(currentTZ === 'local' && usingFallbackLocal){
      placeEl.textContent = `${currentLabel} · Following device time`;
    }else{
      placeEl.textContent = `${currentLabel} · Local time`;
    }

    const state = getState(hour);
    STATES.forEach(s => document.body.classList.remove(`state-${s}`));
    document.body.classList.add(`state-${state}`);

    const t = getTextFor(state, hour, min, currentLabel);
    labelEl.textContent = t.label;
    poemEl.innerHTML    = t.poem;
  }

  // 프리셋 버튼
  locButtons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      locButtons.forEach(b=>b.classList.remove('is-active'));
      btn.classList.add('is-active');
      currentTZ = btn.dataset.tz || 'local';
      currentLabel = btn.dataset.label || 'This place';
      usingFallbackLocal = false;
      locInput.value = '';
      updateScene();
    });
  });

  // 텍스트 입력으로 도시 설정
  locForm.addEventListener('submit', (e)=>{
    e.preventDefault();
    const raw = locInput.value.trim();
    if(!raw) return;

    const key = raw.toLowerCase();
    const mapped = CITY_TIMEZONES[key];

    locButtons.forEach(b=>b.classList.remove('is-active'));

    if(mapped){
      currentTZ = mapped.tz;
      currentLabel = mapped.label;
      usingFallbackLocal = false;
    }else{
      currentTZ = 'local';
      currentLabel = raw;
      usingFallbackLocal = true;
    }
    updateScene();
  });

  // 초기 실행 + 1초마다 업데이트
  updateScene();
  setInterval(updateScene, 1000);
</script>
</body>
</html>
